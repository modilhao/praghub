<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MVP – Scanner de Compliance (Setor de Controle de Pragas)</title>
  <meta name="description" content="Prova de conceito: scanner rápido de compliance para empresas de controle de pragas. Gera score, diagnóstico e plano de 30 dias.">
  <style>
    :root{
      --bg:#0f1220; --panel:#171a2b; --muted:#9aa3b2; --text:#e6eaf2; --accent:#6ee7b7; --danger:#f87171; --warn:#fbbf24; --ok:#34d399;
    }
    *{box-sizing:border-box}
    body{margin:0; font-family: system-ui,-apple-system,Segoe UI,Roboto,Inter,Ubuntu,"Helvetica Neue",Arial; background:var(--bg); color:var(--text);}
    header{padding:20px; text-align:center; border-bottom:1px solid #22253a}
    header h1{margin:0 0 6px; font-size: clamp(20px, 2.8vw, 28px)}
    header p{margin:0; color:var(--muted)}
    .wrap{max-width:1100px; margin:20px auto; padding:16px}
    .grid{display:grid; grid-template-columns: 1fr; gap:16px}
    @media(min-width:980px){ .grid{grid-template-columns: 1.1fr .9fr} }
    .card{background:var(--panel); border:1px solid #232642; border-radius:16px; padding:18px}
    .card h2{margin:0 0 12px; font-size: clamp(18px, 2.2vw, 22px)}
    .muted{color:var(--muted)}
    label{display:block; margin:10px 0 6px}
    input[type=text], input[type=email], input[type=tel], select, textarea{
      width:100%; padding:12px 14px; border-radius:12px; border:1px solid #2a2d4a; background:#0f1326; color:var(--text);
    }
    .q{margin:12px 0; padding:12px; border-radius:12px; border:1px solid #2a2d4a; background:#10142a}
    .q legend{font-weight:600}
    .yn{display:flex; gap:14px; margin-top:6px}
    .yn label{display:flex; align-items:center; gap:6px; margin:0}
    .actions{display:flex; flex-wrap:wrap; gap:10px; margin-top:14px}
    button{border:0; padding:12px 16px; border-radius:12px; cursor:pointer; font-weight:600}
    .primary{background:linear-gradient(135deg,#22c55e,#06b6d4); color:#052015}
    .ghost{background:#0f1326; color:var(--text); border:1px solid #2a2d4a}
    .danger{background:#3b0d12; color:#fecaca; border:1px solid #7f1d1d}
    .result{display:none}
    .score{font-size: clamp(48px, 7vw, 88px); font-weight:800; line-height:1; letter-spacing:-1px}
    .pill{display:inline-block; padding:6px 10px; border-radius:999px; font-weight:700}
    .pill.warn{background:#3a2a08; color:#fde68a}
    .pill.ok{background:#052d23; color:#b7f7d6}
    .pill.crit{background:#3b0d12; color:#fecaca}
    .list{margin:10px 0 0; padding-left:18px}
    .disclaimer{font-size:12px; color:var(--muted)}
    .footer{margin-top:12px; color:var(--muted); font-size:12px}
    .badge{display:inline-flex; align-items:center; gap:8px; padding:8px 12px; border-radius:999px; background:#0b2d22; color:#a7f3d0; border:1px solid #115e59}
    .two{display:grid; grid-template-columns:1fr; gap:10px}
    @media(min-width:650px){ .two{grid-template-columns:1fr 1fr} }
    hr{border:0; border-top:1px solid #22253a; margin:14px 0}
    .print-only{display:none}
    @media print{ .no-print{display:none} .print-only{display:block} body{background:#fff; color:#111} .card{border:0; background:#fff} header{border:0} }
    .success{background:#052d23; color:#b7f7d6; padding:10px 12px; border-radius:10px; border:1px solid #115e59; display:none; margin-top:10px}
    .error{background:#3b0d12; color:#fecaca; padding:10px 12px; border-radius:10px; border:1px solid #7f1d1d; display:none; margin-top:10px}
  </style>
</head>
<body>
  <header>
    <h1>Associação Digital de Controle de Pragas — <span style="color:var(--accent)">MVP</span></h1>
    <p>Prova de Conceito • Jundiaí • 21/11/2025 — Scanner de Compliance + Geração de Relatório</p>
  </header>

  <div class="wrap grid">
    <section class="card">
      <h2>1) Dados da Empresa</h2>
      <div class="two">
        <div>
          <label>Razão Social*</label>
          <input id="empresa" type="text" required placeholder="Ex.: Dedetiza&cia Ltda"/>
        </div>
        <div>
          <label>CNPJ</label>
          <input id="cnpj" type="text" placeholder="00.000.000/0001-00"/>
        </div>
        <div>
          <label>Contato (nome)*</label>
          <input id="contato" type="text" required placeholder="Nome do responsável"/>
        </div>
        <div>
          <label>E-mail*</label>
          <input id="email" type="email" required placeholder="email@empresa.com.br"/>
        </div>
        <div>
          <label>WhatsApp</label>
          <input id="whats" type="tel" placeholder="(11) 9 9999-9999"/>
        </div>
        <div>
          <label>UF*</label>
          <select id="uf" required>
            <option value="">Selecione…</option>
            <option>AC</option><option>AL</option><option>AP</option><option>AM</option>
            <option>BA</option><option>CE</option><option>DF</option><option>ES</option>
            <option>GO</option><option>MA</option><option>MT</option><option>MS</option>
            <option>MG</option><option>PA</option><option>PB</option><option>PR</option>
            <option>PE</option><option>PI</option><option>RJ</option><option>RN</option>
            <option>RS</option><option>RO</option><option>RR</option><option>SC</option>
            <option>SP</option><option>SE</option><option>TO</option>
          </select>
        </div>
      </div>
      <label style="margin-top:10px"><input id="lgpd" type="checkbox"/> Concordo em compartilhar meus dados para avaliação e receber o relatório por e-mail. (LGPD)</label>

      <hr/>
      <h2>2) Scanner RDC 622/2022 — Perguntas</h2>
      <fieldset class="q">
        <legend>1. Responsável Técnico ativo conforme legislação?</legend>
        <div class="yn">
          <label><input type="radio" name="q1" value="sim"/> Sim</label>
          <label><input type="radio" name="q1" value="nao"/> Não</label>
        </div>
        <small class="muted">Peso 2.0 — Ex.: RT com vínculo e documentação comprobatória.</small>
      </fieldset>
      <fieldset class="q">
        <legend>2. POPs (procedimentos) assinados e atualizados?</legend>
        <div class="yn">
          <label><input type="radio" name="q2" value="sim"/> Sim</label>
          <label><input type="radio" name="q2" value="nao"/> Não</label>
        </div>
        <small class="muted">Peso 2.0 — Procedimentos operacionais padrão essenciais.</small>
      </fieldset>
      <fieldset class="q">
        <legend>3. Licença sanitária válida?</legend>
        <div class="yn">
          <label><input type="radio" name="q3" value="sim"/> Sim</label>
          <label><input type="radio" name="q3" value="nao"/> Não</label>
        </div>
        <small class="muted">Peso 2.0 — Documento vigente e disponível.</small>
      </fieldset>
      <fieldset class="q">
        <legend>4. Rastreabilidade de saneantes (ANVISA) e FISPQ?</legend>
        <div class="yn">
          <label><input type="radio" name="q4" value="sim"/> Sim</label>
          <label><input type="radio" name="q4" value="nao"/> Não</label>
        </div>
        <small class="muted">Peso 1.5 — Registros e fichas técnicas organizados.</small>
      </fieldset>
      <fieldset class="q">
        <legend>5. Treinamentos/ASO/PCMSO atualizados?</legend>
        <div class="yn">
          <label><input type="radio" name="q5" value="sim"/> Sim</label>
          <label><input type="radio" name="q5" value="nao"/> Não</label>
        </div>
        <small class="muted">Peso 1.5 — Saúde e segurança ocupacional.</small>
      </fieldset>
      <fieldset class="q">
        <legend>6. Plano de resíduos (quando aplicável, RDC 222/2018)?</legend>
        <div class="yn">
          <label><input type="radio" name="q6" value="sim"/> Sim</label>
          <label><input type="radio" name="q6" value="nao"/> Não</label>
        </div>
        <small class="muted">Peso 1.0 — Gestão e destinação adequadas.</small>
      </fieldset>
      <fieldset class="q">
        <legend>7. Registros de serviço (laudos, evidências, antes/depois)?</legend>
        <div class="yn">
          <label><input type="radio" name="q7" value="sim"/> Sim</label>
          <label><input type="radio" name="q7" value="nao"/> Não</label>
        </div>
        <small class="muted">Peso 1.0 — Rastreabilidade do atendimento.</small>
      </fieldset>
      <fieldset class="q">
        <legend>8. EPIs: inventário e controle de entrega?</legend>
        <div class="yn">
          <label><input type="radio" name="q8" value="sim"/> Sim</label>
          <label><input type="radio" name="q8" value="nao"/> Não</label>
        </div>
        <small class="muted">Peso 1.0 — Segurança do time operacional.</small>
      </fieldset>
      <fieldset class="q">
        <legend>9. LGPD: política e consentimento de clientes?</legend>
        <div class="yn">
          <label><input type="radio" name="q9" value="sim"/> Sim</label>
          <label><input type="radio" name="q9" value="nao"/> Não</label>
        </div>
        <small class="muted">Peso 1.0 — Governança mínima de dados pessoais.</small>
      </fieldset>
      <fieldset class="q">
        <legend>10. Procedimento para não conformidades e ações corretivas?</legend>
        <div class="yn">
          <label><input type="radio" name="q10" value="sim"/> Sim</label>
          <label><input type="radio" name="q10" value="nao"/> Não</label>
        </div>
        <small class="muted">Peso 1.0 — Melhoria contínua e rastreabilidade.</small>
      </fieldset>

      <div class="actions no-print">
        <button class="primary" id="calcBtn">Calcular Score & Gerar Relatório</button>
        <button class="ghost" id="limparBtn">Limpar</button>
      </div>
      <p class="disclaimer">Este é um protótipo de demonstração. Não substitui auditoria oficial. Use para autoavaliação inicial e próximos passos.</p>
    </section>

    <aside class="card">
      <h2>3) Resultado</h2>
      <div id="placeholder" class="muted">Preencha o formulário e clique em <b>Calcular</b> para ver seu resultado aqui.</div>
      <div class="result" id="result">
        <div class="print-only"><h2>Relatório – Scanner de Compliance</h2></div>
        <div style="display:flex; align-items:center; gap:12px; flex-wrap:wrap">
          <div class="badge">Badge Provisório • Candidato a Empresa Verificada</div>
          <span id="nivelPill" class="pill">—</span>
        </div>
        <div style="margin-top:10px">
          <div class="score" id="score">0</div>
          <div class="muted" id="nivel">—</div>
        </div>
        <hr/>
        <h3>Diagnóstico</h3>
        <ul class="list" id="gaps"></ul>
        <h3>Plano 30 dias (sugestões)</h3>
        <ul class="list" id="plan"></ul>
        <div class="success" id="okMsg">Dados enviados com sucesso. Obrigado! ✅</div>
        <div class="error" id="errMsg">Não foi possível enviar agora. Tente novamente. ❌</div>
        <hr/>
        <h3>4) Captação (opcional)</h3>
        <p class="muted">Confirme seu interesse em se tornar associado fundador e receber propostas de negócio.</p>
        <div class="two">
          <div>
            <label>Cidade</label>
            <input id="cidade" type="text" placeholder="Ex.: Jundiaí"/>
          </div>
          <div>
            <label>Segmentos de interesse</label>
            <input id="segmentos" type="text" placeholder="Ex.: condomínios, alimentos, saúde"/>
          </div>
        </div>
        <div class="actions no-print">
          <button class="primary" id="sendBtn">Enviar Dados</button>
          <button class="ghost" id="printBtn">Baixar Relatório (PDF)</button>
          <button class="ghost" id="copyBtn">Copiar Resumo</button>
          <button class="ghost" id="whatsBtn">WhatsApp</button>
        </div>
        <p class="footer">Gerado em <span id="quando"></span> • Evento Jundiaí • MVP v0.2</p>
      </div>
    </aside>
  </div>

<script>
(function(){
  // ======== CONFIG ========
  // Opcional: coloque aqui um webhook para capturar leads (Apps Script, SheetDB, Zapier etc.).
  // Ex.: const WEBHOOK_URL = "https://script.google.com/macros/s/SEU_DEPLOY_ID/exec";
  const WEBHOOK_URL = "https://script.google.com/macros/s/AKfycbwHMTCnfoPki1-KD7WUP8o8dGpFwB9HTtbk7aDFm3LkN8Jh3qlBYaFiY9XnAA86UU8o/exec";

  const weights = { q1:2.0, q2:2.0, q3:2.0, q4:1.5, q5:1.5, q6:1.0, q7:1.0, q8:1.0, q9:1.0, q10:1.0 };
  const total = Object.values(weights).reduce((a,b)=>a+b,0);

  const sel = s=>document.querySelector(s);
  const selAll = s=>Array.from(document.querySelectorAll(s));

  function getAnswer(name){
    const el = document.querySelector(`input[name="${name}"]:checked`);
    return el? el.value : null;
  }

  function scoreLevel(n){
    if(n < 40) return {label:"Crítico – precisa de ajustes imediatos", cls:"crit"};
    if(n < 70) return {label:"Em evolução – priorize gaps-chave", cls:"warn"};
    if(n < 86) return {label:"Audit-Ready – ajustes finais", cls:"ok"};
    return {label:"Excelência – pronto para vitrine", cls:"ok"};
  }

  function buildPlan(missing){
    const tipsMap = {
      q1:"Nomeie/regularize o Responsável Técnico e formalize o vínculo.",
      q2:"Escreva/atualize POPs essenciais e colha assinaturas.",
      q3:"Renove/regularize a licença sanitária e mantenha-a disponível.",
      q4:"Organize registros ANVISA, FISPQ e rastreabilidade dos saneantes.",
      q5:"Atualize ASO/PCMSO e calendário de treinamentos.",
      q6:"Implemente o plano de resíduos conforme aplicável (RDC 222/2018).",
      q7:"Padronize laudos e evidências (antes/depois, assinaturas digitais).",
      q8:"Crie inventário de EPIs e controle de entrega/validade.",
      q9:"Publique política de privacidade e revise consentimentos (LGPD).",
      q10:"Defina fluxo de não conformidades com ações corretivas e registro."
    };
    return missing.map(k=>tipsMap[k]||"Ação recomendada");
  }

  function compute(){
    // Validação básica
    if(!sel('#empresa').value || !sel('#contato').value || !sel('#email').value || !sel('#uf').value){
      alert('Preencha os campos obrigatórios (empresa, contato, e-mail, UF).');
      return;
    }
    if(!sel('#lgpd').checked){
      alert('É necessário consentir o uso de dados (LGPD) para gerar o relatório.');
      return;
    }

    let pts=0; const missing=[];
    for(const q in weights){
      const a = getAnswer(q);
      if(a==="sim") pts += weights[q];
      if(a==="nao" || a===null) missing.push(q);
    }
    const pct = Math.round((pts/total)*100);
    const level = scoreLevel(pct);

    // UI
    sel('#placeholder').style.display='none';
    sel('#result').style.display='block';
    sel('#score').textContent = pct;
    sel('#nivel').textContent = level.label;
    const pill = sel('#nivelPill');
    pill.textContent = pct+" pontos";
    pill.className = 'pill ' + level.cls;

    // gaps
    const gapsList = sel('#gaps');
    gapsList.innerHTML='';
    missing.forEach(q=>{
      const idx = parseInt(q.replace('q',''));
      const legend = document.querySelectorAll('fieldset.q legend')[idx-1];
      const li = document.createElement('li');
      li.textContent = legend ? legend.textContent : q;
      gapsList.appendChild(li);
    });

    // plano
    const planList = sel('#plan');
    planList.innerHTML='';
    buildPlan(missing).forEach(t=>{
      const li = document.createElement('li'); li.textContent = t; planList.appendChild(li);
    });

    // quando
    sel('#quando').textContent = new Date().toLocaleString('pt-BR');
  }

  function clearAll(){
    selAll('input[type=text], input[type=email], input[type=tel]').forEach(i=>i.value='');
    sel('#uf').value='';
    sel('#lgpd').checked=false;
    selAll('input[type=radio]').forEach(r=>r.checked=false);
    sel('#result').style.display='none';
    sel('#placeholder').style.display='block';
  }

  function printReport(){ window.print(); }

  async function copySummary(){
    const empresa = sel('#empresa').value;
    const pct = sel('#score').textContent;
    const nivel = sel('#nivel').textContent;
    const gaps = Array.from(selAll('#gaps li')).map(li=>`- \${li.textContent}`).join('\n');
    const plan = Array.from(selAll('#plan li')).map(li=>`- \${li.textContent}`).join('\n');
    const txt = `Relatório – Scanner de Compliance\nEmpresa: \${empresa}\nScore: \${pct}\nNível: \${nivel}\n\nGaps:\n\${gaps}\n\nPlano 30 dias:\n\${plan}`;
    try{ await navigator.clipboard.writeText(txt); alert('Resumo copiado para a área de transferência.'); }catch(e){ alert('Copie manualmente:\n\n'+txt); }
  }

  function whats(){
    const empresa = encodeURIComponent(sel('#empresa').value);
    const pct = encodeURIComponent(sel('#score').textContent);
    const nivel = encodeURIComponent(sel('#nivel').textContent);
    const msg = `Olá! Gostaria de aderir como membro fundador. Empresa: \${empresa}. Score: \${pct}. Nível: \${nivel}.`;
    window.open('https://wa.me/5511973241927?text='+msg,'_blank');
  }

  async function sendLead(){
    // Monta o payload para envio via Formspree
    const payload = {
      empresa: sel('#empresa').value,
      cnpj: sel('#cnpj').value,
      contato: sel('#contato').value,
      email: sel('#email').value,
      whats: sel('#whats').value,
      uf: sel('#uf').value,
      score: sel('#score').textContent,
      nivel: sel('#nivel').textContent,
      cidade: sel('#cidade').value,
      segmentos: sel('#segmentos').value,
      created_at: new Date().toISOString(),
      _subject: `Novo Lead: ${sel('#empresa').value} - Score ${sel('#score').textContent}`,
      _replyto: sel('#email').value
    };

    const ok = sel('#okMsg'); const err = sel('#errMsg');
    ok.style.display='none'; err.style.display='none';
    
    // Mostra status de envio
    ok.innerHTML = '<strong>📤 Enviando dados...</strong>';
    ok.style.display='block';

    try{
      // Enviar via Formspree
      const response = await fetch('https://formspree.io/f/mpwjozqe', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(payload)
      });
      
      if (response.ok) {
        ok.innerHTML = `
          <strong>✅ Lead enviado com sucesso!</strong><br>
          <small>Os dados foram enviados para a equipe PragHub.<br>
          Você receberá um retorno em breve no email: <strong>${payload.email}</strong></small>
        `;
      } else {
        throw new Error(`Erro HTTP: ${response.status}`);
      }
      
    }catch(e){
      console.error('Erro ao enviar via Formspree:', e);
      
      // Fallback: exibe os dados na tela para cópia manual
      const emailBody = `Novo Lead - Scanner de Compliance\n\n` +
        `Empresa: ${payload.empresa}\n` +
        `CNPJ: ${payload.cnpj}\n` +
        `Contato: ${payload.contato}\n` +
        `Email: ${payload.email}\n` +
        `WhatsApp: ${payload.whats}\n` +
        `UF: ${payload.uf}\n` +
        `Score: ${payload.score}\n` +
        `Nível: ${payload.nivel}\n` +
        `Cidade: ${payload.cidade}\n` +
        `Segmentos: ${payload.segmentos}\n` +
        `Data: ${payload.created_at}`;
      
      ok.innerHTML = `
        <strong>⚠️ Erro no envio automático</strong><br>
        <small>Por favor, copie os dados abaixo e envie para: <strong>leads@praghub.com</strong></small><br>
        <textarea readonly style="width:100%;height:150px;margin-top:10px;font-size:12px;">${emailBody}</textarea>
      `;
    }
  }

  sel('#calcBtn').addEventListener('click', compute);
  sel('#limparBtn').addEventListener('click', clearAll);
  sel('#printBtn').addEventListener('click', printReport);
  sel('#copyBtn').addEventListener('click', copySummary);
  sel('#whatsBtn').addEventListener('click', whats);
  sel('#sendBtn').addEventListener('click', sendLead);
})();
</script>
</body>
</html>
